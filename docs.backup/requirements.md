# WE ASKED 100 PEOPLE - 要件定義書

## 1. アプリケーション概要

### 1.1 基本情報
- **アプリ名**: WE ASKED 100 PEOPLE
- **目的**: 「100人に聞きました」形式のクイズ用データ収集アプリケーション
- **想定利用シーン**: クイズイベントやゲームで使用する回答データの収集と集計
- **技術方針**: Rails 8を使用した限りなくシンプルな実装

### 1.2 コアバリュー
- 質問作成者が簡単にクイズ用の質問を作成し、回答を収集できる
- 回答者は登録不要で気軽に回答できる
- 自動的に類似回答をグルーピングして集計結果を見やすく表示
- SNS（X/Twitter）との連携により回答者を効率的に集める

## 2. ユーザー定義

### 2.1 質問作成者（クイズ出題者）
- **認証方式**: Rails 8標準認証（メール/パスワード）
- **権限**:
  - 質問の作成・編集・削除
  - 集計結果の閲覧（全データ）
  - 回答期限の設定
  - 手動グルーピング機能の使用

### 2.2 回答者
- **認証方式**: 登録不要（Cookie/UUID方式）
- **権限**:
  - 質問への回答（1質問につき1回のみ）
  - 回答後のSNSシェア
  - 他の質問の閲覧・回答

## 3. 機能要件

### 3.1 認証・ユーザー管理機能

#### 3.1.1 質問作成者認証
- メールアドレスとパスワードによる登録・ログイン
- パスワードリセット機能
- セッション管理

#### 3.1.2 回答者識別
- 初回アクセス時にUUIDを生成しCookieに保存
- Cookie有効期限: 30日間
- 同一質問への重複回答を防止

### 3.2 質問管理機能

#### 3.2.1 質問作成
- タイトル入力（必須、100文字以内）
- 回答期限設定（デフォルト: 2週間後）
- 作成後に短縮ID自動生成

#### 3.2.2 質問編集・削除
- タイトルの編集
- 回答期限の変更
- 質問の削除（回答データも含めて削除）

#### 3.2.3 質問一覧表示
- カード形式でのビジュアル表示
- ステータス表示（受付中/締切）
- 現在の回答数表示
- 作成日時・締切日時の表示

### 3.3 回答収集機能

#### 3.3.1 回答フォーム
- URL形式: `/q/[短縮ID]`
- 自由記述入力（最大50文字）
- 絵文字入力対応
- リアルタイムバリデーション

#### 3.3.2 回答送信
- 重複チェック（Cookie/UUID）
- 回答データの保存
- 回答完了画面への遷移

#### 3.3.3 回答後のアクション
- Xシェアボタンの表示
- URLコピー機能
- 「他の質問も見てみる」リンク

### 3.4 集計・分析機能

#### 3.4.1 回答の正規化
- 前後の空白削除
- 大文字・小文字の統一
- 全角・半角の統一
- ひらがな・カタカナの統一（将来的に実装）

#### 3.4.2 自動グルーピング
- 正規化された回答をグループ化
- 同一グループの回答数をカウント
- ランキング形式での並び替え

#### 3.4.3 手動グルーピング
- 異なる表記の回答を手動で統合
- グループの分割機能

#### 3.4.4 集計結果表示
- 上位10件のランキング表示
- 各回答の票数と割合
- 総回答数の表示
- コピー可能なテキスト形式での表示

### 3.5 SNS連携機能

#### 3.5.1 質問作成者のシェア機能
- 「新しいクイズを作成しました！『[質問タイトル]について100人に聞きました』回答はこちら→ [URL]」
- Xシェアボタン（Web Intent API）
- URLコピーボタン

#### 3.5.2 回答者のシェア機能
- 「『[質問タイトル]について』のクイズに回答しました！あなたも挑戦→ [URL]」
- 回答内容は非公開（ネタバレ防止）
- Xシェアボタン（Web Intent API）

## 4. 非機能要件

### 4.1 パフォーマンス
- 同時接続数: 最大100人の同時回答を想定
- レスポンス時間: 3秒以内
- データベース最適化: 適切なインデックス設定

### 4.2 セキュリティ
- CSRF対策
- SQLインジェクション対策
- XSS対策
- セキュアなCookie設定

### 4.3 ユーザビリティ
- 直感的で分かりやすいUI
- エラーメッセージの日本語化
- 適切なバリデーションメッセージ

### 4.4 拡張性
- 多言語対応の準備（i18n設定）
- レスポンシブデザインへの将来対応
- APIエンドポイントの追加可能性

### 4.5 運用・保守
- ログ出力
- エラー監視
- データベースバックアップ

## 5. 制約事項

### 5.1 技術的制約
- Rails 8の標準機能を最大限活用
- 外部サービス依存を最小限に
- シンプルな実装を優先

### 5.2 機能的制約
- 回答者の個人情報は収集しない
- 画像や動画のアップロードは非対応
- リアルタイム集計は非対応（ページリロードで更新）

## 6. 将来的な拡張予定

### 6.1 Phase 2で検討
- より高度な類似回答判定（形態素解析）
- 回答者属性の収集（年代、性別など）
- 複数選択式の質問形式
- グラフによる視覚的な集計結果表示

### 6.2 Phase 3で検討
- モバイルアプリ化
- リアルタイム集計
- 外部サービスとのAPI連携
- 有料プラン（回答数無制限など）

## 7. 用語定義

| 用語 | 説明 |
|------|------|
| 質問作成者 | クイズの出題者。質問を作成し、回答を集計する人 |
| 回答者 | 質問に回答する人。登録不要 |
| 短縮ID | 質問URLに使用される短い識別子 |
| 正規化 | 回答の表記ゆれを統一する処理 |
| グルーピング | 類似回答をまとめる処理 |
| Cookie/UUID | 回答者を識別するための仕組み |